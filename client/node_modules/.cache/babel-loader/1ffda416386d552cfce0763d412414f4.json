{"ast":null,"code":"import _regeneratorRuntime from \"/Users/rafalcymbalista/Projects/GhOSt_app/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/rafalcymbalista/Projects/GhOSt_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/rafalcymbalista/Projects/GhOSt_app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/rafalcymbalista/Projects/GhOSt_app/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/rafalcymbalista/Projects/GhOSt_app/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/rafalcymbalista/Projects/GhOSt_app/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/rafalcymbalista/Projects/GhOSt_app/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/rafalcymbalista/Projects/GhOSt_app/client/src/views/AdminPanel/components/UsersTable.jsx\";\nimport React, { Component } from 'react';\nimport { HTMLTable, Button, NonIdealState, H5, Spinner, Menu, MenuItem, ContextMenu, Overlay, Alert, Dialog, Icon } from '@blueprintjs/core';\nimport Client from '../../../Modules/Client/Client';\nimport CreateUserForm from './CreateUserForm';\n\nvar UsersTable =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(UsersTable, _Component);\n\n  function UsersTable(props) {\n    var _this;\n\n    _classCallCheck(this, UsersTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UsersTable).call(this, props));\n    _this.state = {\n      users: [],\n      isLoading: true,\n      errorMsg: '',\n      showEditCard: false,\n      userForEdit: {}\n    };\n    return _this;\n  }\n\n  _createClass(UsersTable, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getData();\n    }\n  }, {\n    key: \"setLoading\",\n    value: function setLoading(loading) {\n      this.setState({\n        isLoading: loading\n      });\n    }\n  }, {\n    key: \"resetErrorMsg\",\n    value: function resetErrorMsg() {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }, {\n    key: \"getData\",\n    value: function () {\n      var _getData = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setLoading(true);\n                _context.prev = 1;\n                this.resetErrorMsg();\n                _context.next = 5;\n                return Client.Services.UsersService.getUsers();\n\n              case 5:\n                result = _context.sent;\n                this.setState({\n                  users: result.data\n                });\n                _context.next = 13;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n                this.setState({\n                  errorMsg: _context.t0.response.status\n                });\n                Client.Notifications.alert('Error while loading users list');\n\n              case 13:\n                _context.prev = 13;\n                this.setLoading(false);\n                return _context.finish(13);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 9, 13, 16]]);\n      }));\n\n      function getData() {\n        return _getData.apply(this, arguments);\n      }\n\n      return getData;\n    }()\n  }, {\n    key: \"deleteUser\",\n    value: function () {\n      var _deleteUser = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(id) {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.setLoading(true);\n                _context2.prev = 1;\n                this.resetErrorMsg();\n                _context2.next = 5;\n                return Client.Services.UsersService.deleteUser(id);\n\n              case 5:\n                result = _context2.sent;\n\n                if (result.status === 200) {\n                  Client.Notifications.success('User removed successfully');\n                }\n\n                _context2.next = 13;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](1);\n                this.setState({\n                  errorMsg: _context2.t0.response.status\n                });\n                Client.Notifications.alert('Error, cannot delete user');\n\n              case 13:\n                _context2.prev = 13;\n                this.getData();\n                this.setLoading(false);\n                return _context2.finish(13);\n\n              case 17:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[1, 9, 13, 17]]);\n      }));\n\n      function deleteUser(_x) {\n        return _deleteUser.apply(this, arguments);\n      }\n\n      return deleteUser;\n    }()\n  }, {\n    key: \"editUser\",\n    value: function editUser(user) {\n      this.setState({\n        showEditCard: true,\n        userForEdit: user\n      });\n    }\n  }, {\n    key: \"closeEditUser\",\n    value: function closeEditUser() {\n      this.setState({\n        showEditCard: false,\n        userForEdit: null\n      });\n    }\n  }, {\n    key: \"renderTableHeader\",\n    value: function renderTableHeader() {\n      return React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, \"User Name\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, \"Role\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, \"Role\")));\n    }\n  }, {\n    key: \"renderTableBody\",\n    value: function renderTableBody() {\n      return React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      }, this.renderTableRows());\n    }\n  }, {\n    key: \"renderTableRows\",\n    value: function renderTableRows() {\n      var _this2 = this;\n\n      return this.state.users.map(function (user) {\n        return React.createElement(\"tr\", {\n          key: user._id,\n          onContextMenu: function onContextMenu(e) {\n            return _this2.handeClick(e, user);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }, user.username), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105\n          },\n          __self: this\n        }, user.email), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }, user.role));\n      });\n    }\n  }, {\n    key: \"handeClick\",\n    value: function handeClick(e, user) {\n      e.preventDefault();\n      ContextMenu.show(this.renderContextMenu(e, user), {\n        left: e.clientX,\n        top: e.clientY\n      });\n    }\n  }, {\n    key: \"renderContextMenu\",\n    value: function renderContextMenu(e, user) {\n      var _this3 = this;\n\n      return React.createElement(Menu, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(MenuItem, {\n        icon: \"user\",\n        text: \"\".concat(user.role, \"/\").concat(user.username, \" \"),\n        disabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }), React.createElement(Menu.Divider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }), React.createElement(MenuItem, {\n        icon: \"edit\",\n        text: \"Edit User\",\n        onClick: function onClick() {\n          return _this3.editUser(user);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }), React.createElement(MenuItem, {\n        icon: \"remove\",\n        text: \"Remove user\",\n        onClick: function onClick() {\n          return _this3.deleteUser(user._id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }), React.createElement(MenuItem, {\n        icon: \"properties\",\n        text: \"Show more...\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }));\n    }\n  }, {\n    key: \"renderContent\",\n    value: function renderContent() {\n      var _this4 = this;\n\n      if (this.state.errorMsg) {\n        return React.createElement(NonIdealState, {\n          icon: \"issue\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }, React.createElement(H5, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }, \"Something went wrong\")), React.createElement(\"i\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148\n          },\n          __self: this\n        }, \"Cannot load users table\"), React.createElement(Button, {\n          icon: \"refresh\",\n          minimal: true,\n          onClick: function onClick() {\n            return _this4.getData();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }));\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"text-right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, React.createElement(Button, {\n        icon: \"refresh\",\n        intent: \"\",\n        onClick: function onClick() {\n          return _this4.getData();\n        },\n        small: true,\n        minimal: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      })), React.createElement(HTMLTable, {\n        fill: true,\n        condensed: true,\n        striped: true,\n        interactive: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, this.renderTableHeader(), this.renderTableBody()));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      if (this.state.isLoading) {\n        return React.createElement(Spinner, {\n          intent: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, this.renderContent(), React.createElement(Dialog, {\n        icon: \"edit\",\n        title: \"Edit User\",\n        isOpen: this.state.showEditCard,\n        onClose: function onClose() {\n          return _this5.closeEditUser();\n        },\n        canEscapeKeyClose: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"p-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        icon: \"edit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }), React.createElement(H5, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"Edit User\"), React.createElement(CreateUserForm, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return UsersTable;\n}(Component);\n\nexport { UsersTable as default };","map":{"version":3,"sources":["/Users/rafalcymbalista/Projects/GhOSt_app/client/src/views/AdminPanel/components/UsersTable.jsx"],"names":["React","Component","HTMLTable","Button","NonIdealState","H5","Spinner","Menu","MenuItem","ContextMenu","Overlay","Alert","Dialog","Icon","Client","CreateUserForm","UsersTable","props","state","users","isLoading","errorMsg","showEditCard","userForEdit","getData","loading","setState","setLoading","resetErrorMsg","Services","UsersService","getUsers","result","data","response","status","Notifications","alert","id","deleteUser","success","user","renderTableRows","map","_id","e","handeClick","username","email","role","preventDefault","show","renderContextMenu","left","clientX","top","clientY","editUser","renderTableHeader","renderTableBody","renderContent","closeEditUser"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n   HTMLTable,\n   Button,\n   NonIdealState,\n   H5,\n   Spinner,\n   Menu,\n   MenuItem,\n   ContextMenu,\n   Overlay,\n   Alert,\n   Dialog,\n   Icon\n} from '@blueprintjs/core';\n\nimport Client from '../../../Modules/Client/Client';\nimport CreateUserForm from './CreateUserForm';\n\nexport default class UsersTable extends Component {\n   constructor(props) {\n      super(props);\n      this.state = {\n         users: [],\n         isLoading: true,\n         errorMsg: '',\n         showEditCard: false,\n         userForEdit: {}\n      };\n   }\n   componentDidMount() {\n      this.getData();\n   }\n   setLoading(loading) {\n      this.setState({\n         isLoading: loading\n      });\n   }\n   resetErrorMsg() {\n      this.setState({\n         errorMsg: ''\n      });\n   }\n   async getData() {\n      this.setLoading(true);\n      var result;\n      try {\n         this.resetErrorMsg();\n         result = await Client.Services.UsersService.getUsers();\n         this.setState({\n            users: result.data\n         });\n      } catch (err) {\n         this.setState({ errorMsg: err.response.status });\n         Client.Notifications.alert('Error while loading users list');\n      } finally {\n         this.setLoading(false);\n      }\n   }\n   async deleteUser(id) {\n      this.setLoading(true);\n      var result;\n      try {\n         this.resetErrorMsg();\n         result = await Client.Services.UsersService.deleteUser(id);\n         if (result.status === 200) {\n            Client.Notifications.success('User removed successfully');\n         }\n      } catch (err) {\n         this.setState({ errorMsg: err.response.status });\n         Client.Notifications.alert('Error, cannot delete user');\n      } finally {\n         this.getData();\n         this.setLoading(false);\n      }\n   }\n\n   editUser(user) {\n      this.setState({ showEditCard: true, userForEdit: user });\n   }\n\n   closeEditUser() {\n      this.setState({ showEditCard: false, userForEdit: null });\n   }\n\n   renderTableHeader() {\n      return (\n         <thead>\n            <tr>\n               <th>User Name</th>\n               <th>Role</th>\n               <th>Role</th>\n            </tr>\n         </thead>\n      );\n   }\n   renderTableBody() {\n      return <tbody>{this.renderTableRows()}</tbody>;\n   }\n   renderTableRows() {\n      return this.state.users.map(user => {\n         return (\n            <tr key={user._id} onContextMenu={e => this.handeClick(e, user)}>\n               <td>{user.username}</td>\n               <td>{user.email}</td>\n               <td>{user.role}</td>\n            </tr>\n         );\n      });\n   }\n   handeClick(e, user) {\n      e.preventDefault();\n      ContextMenu.show(this.renderContextMenu(e, user), {\n         left: e.clientX,\n         top: e.clientY\n      });\n   }\n   renderContextMenu(e, user) {\n      return (\n         <Menu>\n            <MenuItem\n               icon='user'\n               text={`${user.role}/${user.username} `}\n               disabled\n            />\n            <Menu.Divider />\n            <MenuItem\n               icon='edit'\n               text='Edit User'\n               onClick={() => this.editUser(user)}\n            />\n            <MenuItem\n               icon='remove'\n               text='Remove user'\n               onClick={() => this.deleteUser(user._id)}\n            />\n            <MenuItem icon='properties' text='Show more...' />\n         </Menu>\n      );\n   }\n   renderContent() {\n      if (this.state.errorMsg) {\n         return (\n            <NonIdealState icon='issue'>\n               <H5>\n                  <strong>Something went wrong</strong>\n               </H5>\n               <i>Cannot load users table</i>\n               <Button\n                  icon='refresh'\n                  minimal\n                  onClick={() => this.getData()}\n               ></Button>\n            </NonIdealState>\n         );\n      }\n      return (\n         <div>\n            <div className='text-right'>\n               <Button\n                  icon='refresh'\n                  intent=''\n                  onClick={() => this.getData()}\n                  small\n                  minimal\n               ></Button>\n            </div>\n            <HTMLTable fill condensed striped interactive>\n               {this.renderTableHeader()}\n               {this.renderTableBody()}\n            </HTMLTable>\n         </div>\n      );\n   }\n\n   render() {\n      if (this.state.isLoading) {\n         return <Spinner intent='primary'></Spinner>;\n      }\n      return (\n         <div>\n            {this.renderContent()}\n            <Dialog\n               icon='edit'\n               title='Edit User'\n               isOpen={this.state.showEditCard}\n               onClose={() => this.closeEditUser()}\n               canEscapeKeyClose={true}\n            >\n               <div className='p-2'>\n                  <Icon icon='edit' />\n                  <H5>Edit User</H5>\n                  <CreateUserForm></CreateUserForm>\n               </div>\n            </Dialog>\n         </div>\n      );\n   }\n}\n"]},"metadata":{},"sourceType":"module"}