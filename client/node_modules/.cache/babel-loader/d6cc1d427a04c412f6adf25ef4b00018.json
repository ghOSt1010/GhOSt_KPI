{"ast":null,"code":"import _defineProperty from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/rafalcymbalista/Projects/scarlet_app/client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/rafalcymbalista/Projects/scarlet_app/client/src/components/Table/EmployeeTable/EmployeeAvailabilityReportingTable.jsx\";\nimport React, { Component } from 'react';\nimport { Table, Button, Input, Spinner, Progress } from 'reactstrap';\nimport axios from 'axios';\n\nvar EmployeeAvailabilityReportingTable =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EmployeeAvailabilityReportingTable, _Component);\n\n  function EmployeeAvailabilityReportingTable(props) {\n    var _this;\n\n    _classCallCheck(this, EmployeeAvailabilityReportingTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EmployeeAvailabilityReportingTable).call(this, props));\n\n    _this.handleSubmit =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                console.log(_this.state.empArr);\n                /*\r\n                var readyempReport = this.state.empArr.map((emp, index) => {\r\n                   return {\r\n                      reportedAt: emp.reportedAt,\r\n                      project: emp.project._id,\r\n                      emp_id: emp._id,\r\n                      emp: emp.emp,\r\n                      logic: emp.logic,\r\n                      empType: emp.type.type,\r\n                      target: emp.target,\r\n                      result: emp.result,\r\n                      status: emp.status\r\n                   };\r\n                });\r\n                  var data = {\r\n                   empReport: readyempReport\r\n                };\r\n                  const URL =\r\n                   '/api/reports/report/employee/availability/';\r\n                  this.setState({\r\n                   isCompleted: await this.isCompleted()\r\n                });\r\n                  if (this.state.isCompleted) {\r\n                   axios.post(URL, data).then(doc => {\r\n                      alert('emp Report saved successfully');\r\n                      this.setState({\r\n                         enableInputs: false\r\n                      });\r\n                   });\r\n                } else {\r\n                   alert('emp Report not completed yet');\r\n                }\r\n                */\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.getEmployees = _this.getEmployees.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.renderTableHeaders = _this.renderTableHeaders.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.renderTableData = _this.renderTableData.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.state = {\n      modal: false,\n      theme: _this.props.theme,\n      isLoading: true,\n      workingHoursTarget: 160,\n      enableInputs: true,\n      empArr: [],\n      isCompleted: false\n    };\n    return _this;\n  }\n\n  _createClass(EmployeeAvailabilityReportingTable, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getEmployees();\n    }\n  }, {\n    key: \"getEmployees\",\n    value: function getEmployees() {\n      var _this2 = this;\n\n      this.setState({\n        isLoading: true\n      });\n      var URL = '/api/employees/';\n      axios.get(URL).then(function (res) {\n        var correctData = res.data.map(function (emp, index) {\n          return {\n            _id: emp._id,\n            project: emp.project,\n            name: emp.name,\n            role: emp.role,\n            sap: emp.sap,\n            trainingHours: 0,\n            annualLeave: 0,\n            sickLeave: 0,\n            unplannedLeave: 0,\n            workingHoursTarget: 160,\n            productiveHours: 160,\n            availability: 1\n          };\n        });\n\n        _this2.setState({\n          empArr: correctData,\n          isLoading: false\n        });\n      }).catch(function (err) {\n        alert('Error loading Employees Availability table');\n        console.log(JSON.stringify(err));\n      });\n    }\n  }, {\n    key: \"setTheme\",\n    value: function setTheme() {\n      var theme = this.state.theme;\n\n      if (theme === 'dark') {\n        return 'bg-dark text-white table-dark';\n      }\n\n      if (theme === 'light') {\n        return '';\n      }\n    }\n  }, {\n    key: \"setCardTheme\",\n    value: function setCardTheme() {\n      var theme = this.state.theme;\n\n      if (theme === 'dark') {\n        return 'bg-dark text-white';\n      }\n\n      if (theme === 'light') {\n        return '';\n      }\n    }\n  }, {\n    key: \"setInputTheme\",\n    value: function setInputTheme() {\n      var theme = this.props.theme;\n\n      if (theme === 'dark') {\n        return 'bg-transparent text-white no-border text-center';\n      }\n\n      if (theme === 'light') {\n        return 'bg-transparent text-center';\n      }\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(index, dataType, value) {\n      var _this3 = this;\n\n      var newState = this.state.empArr.map(function (item, i) {\n        if (i === index) {\n          return _objectSpread({}, item, _defineProperty({}, dataType, value));\n        }\n\n        item.productiveHours = _this3.state.workingHoursTarget;\n        item.productiveHours = item.productiveHours - item.trainingHours - item.annualLeave - item.sickLeave - item.unplannedLeave;\n        return item;\n      });\n      this.setState({\n        empArr: newState\n      });\n    }\n  }, {\n    key: \"renderTableHeaders\",\n    value: function renderTableHeaders() {\n      return React.createElement(\"tr\", {\n        className: \"bg-black text-white\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, \"Date\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, \"Project\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, \"SAP\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, \"Name\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, \"Role\"), React.createElement(\"th\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, \"Working hours\"), React.createElement(\"th\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, \"Training Hours\"), React.createElement(\"th\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"Annual Leave\"), React.createElement(\"th\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, \"Sick Leave\"), React.createElement(\"th\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, \"Unplanned Leave\"), React.createElement(\"th\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, \"Productive Hours\"), React.createElement(\"th\", {\n        className: \"text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, \"Availability\"));\n    }\n  }, {\n    key: \"renderTableData\",\n    value: function renderTableData() {\n      var _this4 = this;\n\n      return this.state.empArr.map(function (emp, index) {\n        return React.createElement(\"tr\", {\n          key: emp._id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }, emp.reportedAt = new Date().toLocaleDateString()), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, emp.project.name), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, emp.sap), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }, emp.name), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, emp.role.role), React.createElement(\"td\", {\n          className: \"text-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }, _this4.state.workingHoursTarget), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, React.createElement(Input, {\n          type: \"number\",\n          onChange: function onChange(e) {\n            return _this4.handleChange(index, 'trainingHours', parseFloat(e.target.value));\n          },\n          step: \"0.001\",\n          min: \"0\",\n          value: _this4.state.empArr[index].trainingHours,\n          size: \"sm\",\n          disabled: !_this4.state.enableInputs,\n          className: _this4.setInputTheme(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        })), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }, React.createElement(Input, {\n          type: \"number\",\n          onChange: function onChange(e) {\n            return _this4.handleChange(index, 'annualLeave', parseFloat(e.target.value));\n          },\n          step: \"0.001\",\n          min: \"0\",\n          value: _this4.state.empArr[index].annualLeave,\n          size: \"sm\",\n          disabled: !_this4.state.enableInputs,\n          className: _this4.setInputTheme(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        })), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177\n          },\n          __self: this\n        }, React.createElement(Input, {\n          type: \"number\",\n          onChange: function onChange(e) {\n            return _this4.handleChange(index, 'sickLeave', parseFloat(e.target.value));\n          },\n          step: \"0.001\",\n          min: \"0\",\n          value: _this4.state.empArr[index].sickLeave,\n          size: \"sm\",\n          disabled: !_this4.state.enableInputs,\n          className: _this4.setInputTheme(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        })), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }, React.createElement(Input, {\n          type: \"number\",\n          onChange: function onChange(e) {\n            return _this4.handleChange(index, 'unplannedLeave', parseFloat(e.target.value));\n          },\n          step: \"0.001\",\n          min: \"0\",\n          value: _this4.state.empArr[index].unplannedLeave,\n          size: \"sm\",\n          disabled: !_this4.state.enableInputs,\n          className: _this4.setInputTheme(),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        })), React.createElement(\"td\", {\n          className: \"text-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213\n          },\n          __self: this\n        }, emp.productiveHours = _this4.calcProductiveHours(emp)), React.createElement(\"td\", {\n          className: \"align-middle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216\n          },\n          __self: this\n        }, React.createElement(Progress, {\n          className: _this4.setInputTheme(),\n          value: emp.availability,\n          color: emp.productiveHours / _this4.state.workingHoursTarget >= 0.8 ? 'success' : 'primary',\n          max: 1,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217\n          },\n          __self: this\n        }, Math.round(emp.availability * 100) + ' %')));\n      });\n    }\n  }, {\n    key: \"calcProductiveHours\",\n    value: function calcProductiveHours(emp) {\n      emp.productiveHours = this.state.workingHoursTarget;\n      emp.productiveHours = isNaN(emp.productiveHours) ? 0 : emp.productiveHours;\n      emp.trainingHours = isNaN(emp.trainingHours) ? 0 : emp.trainingHours;\n      emp.annualLeave = isNaN(emp.annualLeave) ? 0 : emp.annualLeave;\n      emp.sickLeave = isNaN(emp.sickLeave) ? 0 : emp.sickLeave;\n      emp.unplannedLeave = isNaN(emp.unplannedLeave) ? 0 : emp.unplannedLeave;\n      emp.productiveHours = emp.productiveHours - emp.trainingHours - emp.annualLeave - emp.sickLeave - emp.unplannedLeave;\n      emp.availability = Math.round(emp.productiveHours / this.state.workingHoursTarget * 100) / 100;\n      return emp.productiveHours;\n    }\n  }, {\n    key: \"isCompleted\",\n    value: function () {\n      var _isCompleted = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var empArr, isReady, i;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                empArr = this.state.empArr;\n                isReady = false;\n                i = 0;\n\n              case 3:\n                if (!(i < empArr.length)) {\n                  _context2.next = 11;\n                  break;\n                }\n\n                if (!(isNaN(empArr[i].result) || empArr[i].result === null)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                _context2.next = 7;\n                return isReady;\n\n              case 7:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 8:\n                i++;\n                _context2.next = 3;\n                break;\n\n              case 11:\n                _context2.next = 13;\n                return !isReady;\n\n              case 13:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function isCompleted() {\n        return _isCompleted.apply(this, arguments);\n      }\n\n      return isCompleted;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          empArr = _this$state.empArr,\n          isLoading = _this$state.isLoading;\n\n      if (isLoading) {\n        return React.createElement(\"div\", {\n          className: \"text-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 320\n          },\n          __self: this\n        }, React.createElement(Spinner, {\n          color: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 321\n          },\n          __self: this\n        }));\n      }\n\n      if (empArr.length === 0) {\n        return React.createElement(\"div\", {\n          className: \"text-center text-secondary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 328\n          },\n          __self: this\n        }, React.createElement(\"h6\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 329\n          },\n          __self: this\n        }, \"No emps found...\"));\n      }\n\n      return React.createElement(\"div\", {\n        className: \"mt-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 335\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 336\n        },\n        __self: this\n      }, \"emps to Report\", React.createElement(Button, {\n        color: \"primary\",\n        size: \"sm\",\n        ref: \"getEmployeesData\",\n        id: \"getEmployeesData\",\n        className: \"float-right\",\n        onClick: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 338\n        },\n        __self: this\n      }, \"Submit \", React.createElement(\"span\", {\n        className: \"fas fa-check ml-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346\n        },\n        __self: this\n      }))), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 349\n        },\n        __self: this\n      }), React.createElement(Table, {\n        responsive: true,\n        borderless: true,\n        striped: true,\n        hover: true,\n        size: \"sm\",\n        className: this.setTheme(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 350\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 358\n        },\n        __self: this\n      }, this.renderTableHeaders()), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      }, this.renderTableData())));\n    }\n  }]);\n\n  return EmployeeAvailabilityReportingTable;\n}(Component);\n/*\r\nrequired data structure\r\n==================================================================\r\n   reportedAt: { type: Date, default: Date.now },\r\n   \r\n\r\n   result: { type: Number, required: true },          *to be calculated and send\r\n   status: { type: Boolean, required: true }          **to be calculated and send\r\n                                                         **(server side validation post submit)\r\n===================================================================\r\n*/\n\n\nexport { EmployeeAvailabilityReportingTable as default };","map":{"version":3,"sources":["/Users/rafalcymbalista/Projects/scarlet_app/client/src/components/Table/EmployeeTable/EmployeeAvailabilityReportingTable.jsx"],"names":["React","Component","Table","Button","Input","Spinner","Progress","axios","EmployeeAvailabilityReportingTable","props","handleSubmit","e","preventDefault","console","log","state","empArr","getEmployees","bind","renderTableHeaders","renderTableData","modal","theme","isLoading","workingHoursTarget","enableInputs","isCompleted","setState","URL","get","then","res","correctData","data","map","emp","index","_id","project","name","role","sap","trainingHours","annualLeave","sickLeave","unplannedLeave","productiveHours","availability","catch","err","alert","JSON","stringify","dataType","value","newState","item","i","reportedAt","Date","toLocaleDateString","handleChange","parseFloat","target","setInputTheme","calcProductiveHours","Math","round","isNaN","isReady","length","result","setTheme"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { Table, Button, Input, Spinner, Progress } from 'reactstrap';\r\nimport axios from 'axios';\r\n\r\nexport default class EmployeeAvailabilityReportingTable extends Component {\r\n   constructor(props) {\r\n      super(props);\r\n      this.getEmployees = this.getEmployees.bind(this);\r\n      this.renderTableHeaders = this.renderTableHeaders.bind(this);\r\n      this.renderTableData = this.renderTableData.bind(this);\r\n\r\n      this.state = {\r\n         modal: false,\r\n         theme: this.props.theme,\r\n         isLoading: true,\r\n         workingHoursTarget: 160,\r\n         enableInputs: true,\r\n         empArr: [],\r\n         isCompleted: false\r\n      };\r\n   }\r\n\r\n   componentDidMount() {\r\n      this.getEmployees();\r\n   }\r\n\r\n   getEmployees() {\r\n      this.setState({ isLoading: true });\r\n\r\n      const URL = '/api/employees/';\r\n\r\n      axios\r\n         .get(URL)\r\n         .then(res => {\r\n            var correctData = res.data.map((emp, index) => {\r\n               return {\r\n                  _id: emp._id,\r\n                  project: emp.project,\r\n                  name: emp.name,\r\n                  role: emp.role,\r\n                  sap: emp.sap,\r\n                  trainingHours: 0,\r\n                  annualLeave: 0,\r\n                  sickLeave: 0,\r\n                  unplannedLeave: 0,\r\n                  workingHoursTarget: 160,\r\n                  productiveHours: 160,\r\n                  availability: 1\r\n               };\r\n            });\r\n            this.setState({\r\n               empArr: correctData,\r\n               isLoading: false\r\n            });\r\n         })\r\n         .catch(err => {\r\n            alert('Error loading Employees Availability table');\r\n            console.log(JSON.stringify(err));\r\n         });\r\n   }\r\n\r\n   setTheme() {\r\n      const { theme } = this.state;\r\n      if (theme === 'dark') {\r\n         return 'bg-dark text-white table-dark';\r\n      }\r\n      if (theme === 'light') {\r\n         return '';\r\n      }\r\n   }\r\n\r\n   setCardTheme() {\r\n      const { theme } = this.state;\r\n      if (theme === 'dark') {\r\n         return 'bg-dark text-white';\r\n      }\r\n      if (theme === 'light') {\r\n         return '';\r\n      }\r\n   }\r\n\r\n   setInputTheme() {\r\n      const { theme } = this.props;\r\n      if (theme === 'dark') {\r\n         return 'bg-transparent text-white no-border text-center';\r\n      }\r\n      if (theme === 'light') {\r\n         return 'bg-transparent text-center';\r\n      }\r\n   }\r\n\r\n   handleChange(index, dataType, value) {\r\n      const newState = this.state.empArr.map((item, i) => {\r\n         if (i === index) {\r\n            return { ...item, [dataType]: value };\r\n         }\r\n         item.productiveHours = this.state.workingHoursTarget;\r\n         item.productiveHours =\r\n            item.productiveHours -\r\n            item.trainingHours -\r\n            item.annualLeave -\r\n            item.sickLeave -\r\n            item.unplannedLeave;\r\n         return item;\r\n      });\r\n\r\n      this.setState({\r\n         empArr: newState\r\n      });\r\n   }\r\n\r\n   renderTableHeaders() {\r\n      return (\r\n         <tr className='bg-black text-white'>\r\n            <th>Date</th>\r\n            <th>Project</th>\r\n            <th>SAP</th>\r\n            <th>Name</th>\r\n            <th>Role</th>\r\n            <th className='text-center'>Working hours</th>\r\n            <th className='text-center'>Training Hours</th>\r\n            <th className='text-center'>Annual Leave</th>\r\n            <th className='text-center'>Sick Leave</th>\r\n            <th className='text-center'>Unplanned Leave</th>\r\n            <th className='text-center'>Productive Hours</th>\r\n            <th className='text-center'>Availability</th>\r\n         </tr>\r\n      );\r\n   }\r\n\r\n   renderTableData() {\r\n      return this.state.empArr.map((emp, index) => {\r\n         return (\r\n            <tr key={emp._id}>\r\n               <td>{(emp.reportedAt = new Date().toLocaleDateString())}</td>\r\n               <td>{emp.project.name}</td>\r\n               <td>{emp.sap}</td>\r\n               <td>{emp.name}</td>\r\n               <td>{emp.role.role}</td>\r\n               <td className='text-center'>{this.state.workingHoursTarget}</td>\r\n               <td>\r\n                  <Input\r\n                     type='number'\r\n                     onChange={e =>\r\n                        this.handleChange(\r\n                           index,\r\n                           'trainingHours',\r\n                           parseFloat(e.target.value)\r\n                        )\r\n                     }\r\n                     step='0.001'\r\n                     min='0'\r\n                     value={this.state.empArr[index].trainingHours}\r\n                     size='sm'\r\n                     disabled={!this.state.enableInputs}\r\n                     className={this.setInputTheme()}\r\n                  />\r\n               </td>\r\n               <td>\r\n                  <Input\r\n                     type='number'\r\n                     onChange={e =>\r\n                        this.handleChange(\r\n                           index,\r\n                           'annualLeave',\r\n                           parseFloat(e.target.value)\r\n                        )\r\n                     }\r\n                     step='0.001'\r\n                     min='0'\r\n                     value={this.state.empArr[index].annualLeave}\r\n                     size='sm'\r\n                     disabled={!this.state.enableInputs}\r\n                     className={this.setInputTheme()}\r\n                  />\r\n               </td>\r\n               <td>\r\n                  <Input\r\n                     type='number'\r\n                     onChange={e =>\r\n                        this.handleChange(\r\n                           index,\r\n                           'sickLeave',\r\n                           parseFloat(e.target.value)\r\n                        )\r\n                     }\r\n                     step='0.001'\r\n                     min='0'\r\n                     value={this.state.empArr[index].sickLeave}\r\n                     size='sm'\r\n                     disabled={!this.state.enableInputs}\r\n                     className={this.setInputTheme()}\r\n                  />\r\n               </td>\r\n               <td>\r\n                  <Input\r\n                     type='number'\r\n                     onChange={e =>\r\n                        this.handleChange(\r\n                           index,\r\n                           'unplannedLeave',\r\n                           parseFloat(e.target.value)\r\n                        )\r\n                     }\r\n                     step='0.001'\r\n                     min='0'\r\n                     value={this.state.empArr[index].unplannedLeave}\r\n                     size='sm'\r\n                     disabled={!this.state.enableInputs}\r\n                     className={this.setInputTheme()}\r\n                  />\r\n               </td>\r\n               <td className='text-center'>\r\n                  {(emp.productiveHours = this.calcProductiveHours(emp))}\r\n               </td>\r\n               <td className='align-middle'>\r\n                  <Progress\r\n                     className={this.setInputTheme()}\r\n                     value={emp.availability}\r\n                     color={\r\n                        emp.productiveHours / this.state.workingHoursTarget >=\r\n                        0.8\r\n                           ? 'success'\r\n                           : 'primary'\r\n                     }\r\n                     max={1}\r\n                  >\r\n                     {Math.round(emp.availability * 100) + ' %'}\r\n                  </Progress>\r\n               </td>\r\n            </tr>\r\n         );\r\n      });\r\n   }\r\n\r\n   calcProductiveHours(emp) {\r\n      emp.productiveHours = this.state.workingHoursTarget;\r\n      emp.productiveHours = isNaN(emp.productiveHours)\r\n         ? 0\r\n         : emp.productiveHours;\r\n      emp.trainingHours = isNaN(emp.trainingHours) ? 0 : emp.trainingHours;\r\n      emp.annualLeave = isNaN(emp.annualLeave) ? 0 : emp.annualLeave;\r\n      emp.sickLeave = isNaN(emp.sickLeave) ? 0 : emp.sickLeave;\r\n      emp.unplannedLeave = isNaN(emp.unplannedLeave) ? 0 : emp.unplannedLeave;\r\n\r\n      emp.productiveHours =\r\n         emp.productiveHours -\r\n         emp.trainingHours -\r\n         emp.annualLeave -\r\n         emp.sickLeave -\r\n         emp.unplannedLeave;\r\n\r\n      emp.availability =\r\n         Math.round(\r\n            (emp.productiveHours / this.state.workingHoursTarget) * 100\r\n         ) / 100;\r\n\r\n      return emp.productiveHours;\r\n   }\r\n\r\n   async isCompleted() {\r\n      const { empArr } = this.state;\r\n      var isReady = false;\r\n\r\n      for (let i = 0; i < empArr.length; i++) {\r\n         if (isNaN(empArr[i].result) || empArr[i].result === null) {\r\n            return await isReady;\r\n         }\r\n      }\r\n      return await !isReady;\r\n   }\r\n\r\n   handleSubmit = async e => {\r\n      e.preventDefault();\r\n      console.log(this.state.empArr);\r\n      /*\r\n      var readyempReport = this.state.empArr.map((emp, index) => {\r\n         return {\r\n            reportedAt: emp.reportedAt,\r\n            project: emp.project._id,\r\n            emp_id: emp._id,\r\n            emp: emp.emp,\r\n            logic: emp.logic,\r\n            empType: emp.type.type,\r\n            target: emp.target,\r\n            result: emp.result,\r\n            status: emp.status\r\n         };\r\n      });\r\n\r\n      var data = {\r\n         empReport: readyempReport\r\n      };\r\n\r\n      const URL =\r\n         '/api/reports/report/employee/availability/';\r\n\r\n      this.setState({\r\n         isCompleted: await this.isCompleted()\r\n      });\r\n\r\n      if (this.state.isCompleted) {\r\n         axios.post(URL, data).then(doc => {\r\n            alert('emp Report saved successfully');\r\n            this.setState({\r\n               enableInputs: false\r\n            });\r\n         });\r\n      } else {\r\n         alert('emp Report not completed yet');\r\n      }\r\n      */\r\n   };\r\n\r\n   render() {\r\n      const { empArr, isLoading } = this.state;\r\n\r\n      if (isLoading) {\r\n         return (\r\n            <div className='text-center'>\r\n               <Spinner color='primary' />\r\n            </div>\r\n         );\r\n      }\r\n\r\n      if (empArr.length === 0) {\r\n         return (\r\n            <div className='text-center text-secondary'>\r\n               <h6>No emps found...</h6>\r\n            </div>\r\n         );\r\n      }\r\n\r\n      return (\r\n         <div className='mt-5'>\r\n            <p>\r\n               emps to Report\r\n               <Button\r\n                  color='primary'\r\n                  size='sm'\r\n                  ref='getEmployeesData'\r\n                  id='getEmployeesData'\r\n                  className='float-right'\r\n                  onClick={this.handleSubmit}\r\n               >\r\n                  Submit <span className='fas fa-check ml-2' />\r\n               </Button>\r\n            </p>\r\n            <hr />\r\n            <Table\r\n               responsive\r\n               borderless\r\n               striped\r\n               hover\r\n               size='sm'\r\n               className={this.setTheme()}\r\n            >\r\n               <thead>{this.renderTableHeaders()}</thead>\r\n               <tbody>{this.renderTableData()}</tbody>\r\n            </Table>\r\n         </div>\r\n      );\r\n   }\r\n}\r\n\r\n/*\r\nrequired data structure\r\n==================================================================\r\n   reportedAt: { type: Date, default: Date.now },\r\n   \r\n\r\n   result: { type: Number, required: true },          *to be calculated and send\r\n   status: { type: Boolean, required: true }          **to be calculated and send\r\n                                                         **(server side validation post submit)\r\n===================================================================\r\n*/\r\n"]},"metadata":{},"sourceType":"module"}