{"ast":null,"code":"import _regeneratorRuntime from \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/rafalcymbalista/Projects/GhOSt_KPI/client/src/views/AdminPanel/components/Employees/EmployeesTable.jsx\";\nimport React, { Component } from 'react';\nimport { HTMLTable, Button, NonIdealState, H5, Spinner, ContextMenu, Dialog, Icon, Card } from '@blueprintjs/core';\nimport Client from '../../../../Modules/Client/Client';\nimport EmployeeForm from '../../../../components/Forms/EmployeeForms/EmployeeForm';\nimport CardHeader from '../../../../components/Card/CardHeader';\nimport CardBody from '../../../../components/Card/CardBody';\nimport TableContextMenu from './TableContextMenu';\n\nvar EmployeesTable =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EmployeesTable, _Component);\n\n  function EmployeesTable() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EmployeesTable);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EmployeesTable)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      errorMsg: '',\n      showEditCard: false,\n      employeeForEdit: {}\n    };\n    return _this;\n  }\n\n  _createClass(EmployeesTable, [{\n    key: \"isEligable\",\n    value: function isEligable() {\n      var role = Client.User.getRole();\n      if (role === 'ROOT') return false;\n      if (role === 'ADMIN') return false;\n      return true;\n    }\n  }, {\n    key: \"resetErrorMsg\",\n    value: function resetErrorMsg() {\n      this.setState({\n        errorMsg: ''\n      });\n    }\n  }, {\n    key: \"deleteEmployee\",\n    value: function () {\n      var _deleteEmployee = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(id) {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                this.resetErrorMsg();\n                _context.next = 4;\n                return Client.Services.EmployeesService.deleteEmployeeById(id);\n\n              case 4:\n                result = _context.sent;\n\n                if (result.status === 200) {\n                  Client.Notifications.success('Employee removed successfully');\n                }\n\n                _context.next = 12;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                this.setState({\n                  errorMsg: _context.t0.response.status\n                });\n                Client.Notifications.alert('Error, cannot delete Employee');\n\n              case 12:\n                _context.prev = 12;\n                this.props.onRefresh();\n                return _context.finish(12);\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 8, 12, 15]]);\n      }));\n\n      function deleteEmployee(_x) {\n        return _deleteEmployee.apply(this, arguments);\n      }\n\n      return deleteEmployee;\n    }()\n  }, {\n    key: \"editEmployee\",\n    value: function editEmployee(employee) {\n      this.setState({\n        showEditCard: true,\n        employeeForEdit: employee\n      });\n    }\n  }, {\n    key: \"closeEditUser\",\n    value: function closeEditUser() {\n      this.setState({\n        showEditCard: false\n      });\n    }\n  }, {\n    key: \"renderTableHeader\",\n    value: function renderTableHeader() {\n      return React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }, \"SAP\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, \"Name\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }, \"Email\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }, \"Role\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }, \"Support Type\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, \"Project\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70\n        },\n        __self: this\n      }, \"Language\"), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 71\n        },\n        __self: this\n      }, \"RM\")));\n    }\n  }, {\n    key: \"renderTableBody\",\n    value: function renderTableBody() {\n      return React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, this.renderTableRows());\n    }\n  }, {\n    key: \"renderTableRows\",\n    value: function renderTableRows() {\n      var _this2 = this;\n\n      var employees = this.props.employees;\n      return employees.map(function (emp) {\n        return React.createElement(\"tr\", {\n          key: emp._id,\n          onContextMenu: function onContextMenu(e) {\n            return _this2.handeClick(e, emp);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, _this2.getValue(emp.sap)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86\n          },\n          __self: this\n        }, _this2.getValue(emp.name)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87\n          },\n          __self: this\n        }, _this2.getValue(emp.email)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 88\n          },\n          __self: this\n        }, _this2.getObjectValue(emp.role, 'role')), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, _this2.getValue(emp.supportType)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, _this2.getObjectValue(emp.project, 'name')), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, _this2.getObjectValue(emp.mainlanguage, 'language')), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }, _this2.getObjectValue(emp.rm, 'name')));\n      });\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(val) {\n      try {\n        if (val === undefined || val === null) {\n          return 'N/A';\n        }\n\n        return val;\n      } catch (e) {\n        return '---';\n      }\n    }\n  }, {\n    key: \"getObjectValue\",\n    value: function getObjectValue(obj, val) {\n      if (obj === undefined || obj === null) {\n        return 'N/A';\n      }\n\n      if (obj[val] === undefined || obj[val] === null) {\n        return 'N/A';\n      }\n\n      return obj[val];\n    }\n  }, {\n    key: \"handeClick\",\n    value: function handeClick(e, emp) {\n      e.preventDefault();\n      ContextMenu.show(this.renderContextMenu(e, emp), {\n        left: e.clientX,\n        top: e.clientY\n      });\n    }\n  }, {\n    key: \"renderContextMenu\",\n    value: function renderContextMenu(e, emp) {\n      var _this3 = this;\n\n      return React.createElement(TableContextMenu, {\n        employee: emp,\n        isEligable: this.isEligable(),\n        onEdit: function onEdit() {\n          return _this3.editEmployee(emp);\n        },\n        onRemove: function onRemove() {\n          return _this3.deleteEmployee(emp._id);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"renderContent\",\n    value: function renderContent() {\n      var _this4 = this;\n\n      if (this.state.errorMsg) {\n        return React.createElement(NonIdealState, {\n          icon: \"issue\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }, React.createElement(H5, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 139\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }, \"Something went wrong\")), React.createElement(\"i\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }, \"Cannot load users table\"), React.createElement(Button, {\n          icon: \"refresh\",\n          minimal: true,\n          onClick: function onClick() {\n            return _this4.getData();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }));\n      }\n\n      if (this.props.employees.length === 0) {\n        return React.createElement(NonIdealState, {\n          icon: \"issue\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, React.createElement(H5, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, React.createElement(\"strong\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, \"There are no Employees in database \")), React.createElement(\"i\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, \"No data to be displayed\"), React.createElement(Button, {\n          icon: \"refresh\",\n          minimal: true,\n          onClick: function onClick() {\n            _this4.props.onRefresh();\n\n            _this4.setState({\n              errorMsg: ''\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159\n          },\n          __self: this\n        }));\n      }\n\n      return React.createElement(\"div\", {\n        className: \"overflow-x-scroll\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(HTMLTable, {\n        condensed: true,\n        striped: true,\n        interactive: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, this.renderTableHeader(), this.renderTableBody()));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var employeeForEdit = this.state.employeeForEdit;\n      var isLoading = this.props.isLoading;\n\n      if (isLoading) {\n        return React.createElement(Spinner, {\n          intent: \"primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, this.renderContent(), React.createElement(Dialog, {\n        isOpen: this.state.showEditCard,\n        onClose: function onClose() {\n          return _this5.closeEditUser();\n        },\n        canEscapeKeyClose: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(Card, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      }, React.createElement(CardHeader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        icon: \"user\",\n        className: \"header-icon\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }), \"Edit User\", React.createElement(\"div\", {\n        className: \"float-right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        icon: \"cross\",\n        onClick: function onClick() {\n          return _this5.closeEditUser();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }))), React.createElement(CardBody, {\n        className: \"card-body\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(EmployeeForm, {\n        onChange: this.onChange,\n        onSubmit: this.handleSubmit,\n        sap: employeeForEdit.sap,\n        name: employeeForEdit.name,\n        email: employeeForEdit.email,\n        role: employeeForEdit.role,\n        supportType: employeeForEdit.supportType,\n        project: employeeForEdit.project,\n        mainlanguage: employeeForEdit.mainlanguage,\n        rm: employeeForEdit.rm,\n        buttonCaption: \"Update\",\n        onClear: function onClear() {\n          return _this5.clearForm();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return EmployeesTable;\n}(Component);\n\nexport { EmployeesTable as default };\nEmployeesTable.defaultProps = {\n  employees: [],\n  onRefresh: function onRefresh() {\n    return;\n  }\n};","map":{"version":3,"sources":["/Users/rafalcymbalista/Projects/GhOSt_KPI/client/src/views/AdminPanel/components/Employees/EmployeesTable.jsx"],"names":["React","Component","HTMLTable","Button","NonIdealState","H5","Spinner","ContextMenu","Dialog","Icon","Card","Client","EmployeeForm","CardHeader","CardBody","TableContextMenu","EmployeesTable","state","errorMsg","showEditCard","employeeForEdit","role","User","getRole","setState","id","resetErrorMsg","Services","EmployeesService","deleteEmployeeById","result","status","Notifications","success","response","alert","props","onRefresh","employee","renderTableRows","employees","map","emp","_id","e","handeClick","getValue","sap","name","email","getObjectValue","supportType","project","mainlanguage","rm","val","undefined","obj","preventDefault","show","renderContextMenu","left","clientX","top","clientY","isEligable","editEmployee","deleteEmployee","getData","length","renderTableHeader","renderTableBody","isLoading","renderContent","closeEditUser","onChange","handleSubmit","clearForm","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n   HTMLTable,\n   Button,\n   NonIdealState,\n   H5,\n   Spinner,\n   ContextMenu,\n   Dialog,\n   Icon,\n   Card\n} from '@blueprintjs/core';\nimport Client from '../../../../Modules/Client/Client';\nimport EmployeeForm from '../../../../components/Forms/EmployeeForms/EmployeeForm';\nimport CardHeader from '../../../../components/Card/CardHeader';\nimport CardBody from '../../../../components/Card/CardBody';\nimport TableContextMenu from './TableContextMenu';\n\nexport default class EmployeesTable extends Component {\n   state = {\n      errorMsg: '',\n      showEditCard: false,\n      employeeForEdit: {}\n   };\n   isEligable() {\n      let role = Client.User.getRole();\n      if (role === 'ROOT') return false;\n      if (role === 'ADMIN') return false;\n      return true;\n   }\n   resetErrorMsg() {\n      this.setState({\n         errorMsg: ''\n      });\n   }\n   async deleteEmployee(id) {\n      var result;\n      try {\n         this.resetErrorMsg();\n         result = await Client.Services.EmployeesService.deleteEmployeeById(id);\n         if (result.status === 200) {\n            Client.Notifications.success('Employee removed successfully');\n         }\n      } catch (err) {\n         this.setState({ errorMsg: err.response.status });\n         Client.Notifications.alert('Error, cannot delete Employee');\n      } finally {\n         this.props.onRefresh();\n      }\n   }\n   editEmployee(employee) {\n      this.setState({\n         showEditCard: true,\n         employeeForEdit: employee\n      });\n   }\n   closeEditUser() {\n      this.setState({ showEditCard: false });\n   }\n   renderTableHeader() {\n      return (\n         <thead>\n            <tr>\n               <th>SAP</th>\n               <th>Name</th>\n               <th>Email</th>\n               <th>Role</th>\n               <th>Support Type</th>\n               <th>Project</th>\n               <th>Language</th>\n               <th>RM</th>\n            </tr>\n         </thead>\n      );\n   }\n   renderTableBody() {\n      return <tbody>{this.renderTableRows()}</tbody>;\n   }\n   renderTableRows() {\n      const { employees } = this.props;\n\n      return employees.map(emp => {\n         return (\n            <tr key={emp._id} onContextMenu={e => this.handeClick(e, emp)}>\n               <td>{this.getValue(emp.sap)}</td>\n               <td>{this.getValue(emp.name)}</td>\n               <td>{this.getValue(emp.email)}</td>\n               <td>{this.getObjectValue(emp.role, 'role')}</td>\n               <td>{this.getValue(emp.supportType)}</td>\n               <td>{this.getObjectValue(emp.project, 'name')}</td>\n               <td>{this.getObjectValue(emp.mainlanguage, 'language')}</td>\n               <td>{this.getObjectValue(emp.rm, 'name')}</td>\n            </tr>\n         );\n      });\n   }\n\n   getValue(val) {\n      try {\n         if (val === undefined || val === null) {\n            return 'N/A';\n         }\n         return val;\n      } catch (e) {\n         return '---';\n      }\n   }\n   getObjectValue(obj, val) {\n      if (obj === undefined || obj === null) {\n         return 'N/A';\n      }\n      if (obj[val] === undefined || obj[val] === null) {\n         return 'N/A';\n      }\n      return obj[val];\n   }\n\n   handeClick(e, emp) {\n      e.preventDefault();\n      ContextMenu.show(this.renderContextMenu(e, emp), {\n         left: e.clientX,\n         top: e.clientY\n      });\n   }\n   renderContextMenu(e, emp) {\n      return (\n         <TableContextMenu\n            employee={emp}\n            isEligable={this.isEligable()}\n            onEdit={() => this.editEmployee(emp)}\n            onRemove={() => this.deleteEmployee(emp._id)}\n         />\n      );\n   }\n   renderContent() {\n      if (this.state.errorMsg) {\n         return (\n            <NonIdealState icon='issue'>\n               <H5>\n                  <strong>Something went wrong</strong>\n               </H5>\n               <i>Cannot load users table</i>\n               <Button\n                  icon='refresh'\n                  minimal\n                  onClick={() => this.getData()}\n               ></Button>\n            </NonIdealState>\n         );\n      }\n\n      if (this.props.employees.length === 0) {\n         return (\n            <NonIdealState icon='issue'>\n               <H5>\n                  <strong>There are no Employees in database </strong>\n               </H5>\n               <i>No data to be displayed</i>\n               <Button\n                  icon='refresh'\n                  minimal\n                  onClick={() => {\n                     this.props.onRefresh();\n                     this.setState({\n                        errorMsg: ''\n                     });\n                  }}\n               ></Button>\n            </NonIdealState>\n         );\n      }\n\n      return (\n         <div className='overflow-x-scroll'>\n            <HTMLTable condensed striped interactive>\n               {this.renderTableHeader()}\n               {this.renderTableBody()}\n            </HTMLTable>\n         </div>\n      );\n   }\n   render() {\n      const { employeeForEdit } = this.state;\n      const { isLoading } = this.props;\n\n      if (isLoading) {\n         return <Spinner intent='primary'></Spinner>;\n      }\n\n      return (\n         <div>\n            {this.renderContent()}\n            <Dialog\n               isOpen={this.state.showEditCard}\n               onClose={() => this.closeEditUser()}\n               canEscapeKeyClose={true}\n            >\n               <Card>\n                  <CardHeader>\n                     <Icon icon='user' className='header-icon' />\n                     Edit User\n                     <div className='float-right'>\n                        <Icon\n                           icon='cross'\n                           onClick={() => this.closeEditUser()}\n                        />\n                     </div>\n                  </CardHeader>\n                  <CardBody className='card-body'>\n                     <EmployeeForm\n                        onChange={this.onChange}\n                        onSubmit={this.handleSubmit}\n                        sap={employeeForEdit.sap}\n                        name={employeeForEdit.name}\n                        email={employeeForEdit.email}\n                        role={employeeForEdit.role}\n                        supportType={employeeForEdit.supportType}\n                        project={employeeForEdit.project}\n                        mainlanguage={employeeForEdit.mainlanguage}\n                        rm={employeeForEdit.rm}\n                        buttonCaption='Update'\n                        onClear={() => this.clearForm()}\n                     />\n                  </CardBody>\n               </Card>\n            </Dialog>\n         </div>\n      );\n   }\n}\nEmployeesTable.defaultProps = {\n   employees: [],\n   onRefresh: function() {\n      return;\n   }\n};\n"]},"metadata":{},"sourceType":"module"}